# é¢„æœŸè¾“å‡ºç¤ºä¾‹ (Expected Output Examples)

## API å“åº”ç¤ºä¾‹

### 1. å®‰å…¨å†…å®¹ (Safe Content)
```json
{
  "text": "è¿™ä¸ªäº§å“å¾ˆå¥½ç”¨ï¼Œæ¨èå¤§å®¶è´­ä¹°",
  "model_prob": 0.023,
  "rule_hits": [],
  "rule_score": 0.0,
  "final_prob": 0.023,
  "pred": 0,
  "threshold": 0.5,
  "category_hint": ""
}
```

### 2. å¹¿å‘Š/å¼•æµ (Advertisement/Spam)
```json
{
  "text": "åŠ å¾®ä¿¡VX123456äº†è§£è¯¦æƒ…ï¼Œä½ä»·æ‰¹å‘",
  "model_prob": 0.156,
  "rule_hits": ["WeChat", "Price"],
  "rule_score": 1.0,
  "final_prob": 1.0,
  "pred": 1,
  "threshold": 0.5,
  "category_hint": "å¹¿å‘Š/å¼•æµ"
}
```

### 3. è¾±éª‚/ä»‡æ¨/æ”»å‡» (Abuse/Hate/Attack)
```json
{
  "text": "ä½ è¿™ä¸ªå‚»é€¼ï¼ŒçœŸæ˜¯åƒåœ¾",
  "model_prob": 0.956,
  "rule_hits": [],
  "rule_score": 0.0,
  "final_prob": 0.956,
  "pred": 1,
  "threshold": 0.5,
  "category_hint": "è¾±éª‚/ä»‡æ¨/æ”»å‡»"
}
```

### 4. æ¨¡å‹åˆ¤å®š (Model Only Detection)
```json
{
  "text": "è¿™ä¸ªäººæ˜¯éª—å­ï¼Œåƒä¸‡åˆ«ç›¸ä¿¡",
  "model_prob": 0.823,
  "rule_hits": [],
  "rule_score": 0.0,
  "final_prob": 0.823,
  "pred": 1,
  "threshold": 0.5,
  "category_hint": "æ¨¡å‹åˆ¤å®šï¼ˆæœªå‘½ä¸­è§„åˆ™/è¯è¡¨ï¼‰"
}
```

## Streamlit UI é¢„æœŸå±•ç¤º

### å•æ¡é¢„æµ‹ç»“æœ (Single Prediction Result)

#### Before:
```
æ¨¡å‹æ¦‚ç‡: 0.956
è§„åˆ™åˆ†æ•°: 0.000
æœ€ç»ˆæ¦‚ç‡: 0.956

ğŸš« æœ‰æ¯’/å¹¿å‘Š

è§„åˆ™å‘½ä¸­:
æœªå‘½ä¸­ä»»ä½•è§„åˆ™
```

#### After:
```
æ¨¡å‹æ¦‚ç‡: 0.956
è§„åˆ™åˆ†æ•°: 0.000
æœ€ç»ˆæ¦‚ç‡: 0.956

ğŸš« æœ‰å®³å†…å®¹ï¼ˆè¾±éª‚/ä»‡æ¨/å¼•æµå¹¿å‘Šï¼‰

â„¹ï¸ å¯èƒ½ç±»åˆ«: è¾±éª‚/ä»‡æ¨/æ”»å‡»

è§„åˆ™å‘½ä¸­:
æœªå‘½ä¸­ä»»ä½•è§„åˆ™
```

### æ‰¹é‡é¢„æµ‹ç»Ÿè®¡ (Batch Prediction Statistics)

#### Before:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ€»æ ·æœ¬æ•°   â”‚ æœ‰æ¯’/å¹¿å‘Š â”‚   æ­£å¸¸   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     100     â”‚    25    â”‚    75    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

#### After:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  æ€»æ ·æœ¬æ•°   â”‚  æœ‰å®³å†…å®¹ â”‚ å®‰å…¨å†…å®¹  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚     100     â”‚    25    â”‚    75    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### CSV è¾“å‡ºæ ¼å¼

#### Before:
```csv
content,label,model_prob,rule_hits,rule_score,final_prob,pred
è¿™ä¸ªäº§å“å¾ˆå¥½ç”¨,0,0.023,,0.0,0.023,0
åŠ å¾®ä¿¡VX123,1,0.856,WeChat;Price,1.0,1.0,1
```

#### After:
```csv
content,label,model_prob,rule_hits,rule_score,final_prob,pred,category_hint
è¿™ä¸ªäº§å“å¾ˆå¥½ç”¨,0,0.023,,0.0,0.023,0,
åŠ å¾®ä¿¡VX123,1,0.856,WeChat;Price,1.0,1.0,1,å¹¿å‘Š/å¼•æµ
ä½ æ˜¯å‚»é€¼,1,0.956,,0.0,0.956,1,è¾±éª‚/ä»‡æ¨/æ”»å‡»
```

## ä¾§è¾¹æ ä¿¡æ¯æ›´æ–°

#### Before:
```
æ¨¡å‹ä¿¡æ¯
- æ¨¡å‹è·¯å¾„: outputs/model
- åŸºçº¿æ¨¡å‹: hfl/chinese-roberta-wwm-ext
- ä»»åŠ¡: ToxiCN toxic äºŒåˆ†ç±»
- è§„åˆ™èåˆ: å·²å¯ç”¨
```

#### After:
```
æ¨¡å‹ä¿¡æ¯
- æ¨¡å‹è·¯å¾„: outputs/model
- åŸºçº¿æ¨¡å‹: hfl/chinese-roberta-wwm-ext
- ä»»åŠ¡: å¹¿ä¹‰æœ‰å®³å†…å®¹äºŒåˆ†ç±»
- è§„åˆ™èåˆ: å·²å¯ç”¨
- åˆ†ç±»: è¾±éª‚/ä»‡æ¨/å¼•æµå¹¿å‘Š
```

## å‘½ä»¤è¡Œæµ‹è¯•ç¤ºä¾‹

```bash
# æµ‹è¯•å¹¿å‘Šæ£€æµ‹
curl -X POST "http://localhost:8000/predict" \
  -H "Content-Type: application/json" \
  -d '{"text": "åŠ å¾®ä¿¡VX123äº†è§£è¯¦æƒ…", "threshold": 0.5}'

# é¢„æœŸå“åº”åŒ…å« "category_hint": "å¹¿å‘Š/å¼•æµ"

# æµ‹è¯•è¾±éª‚æ£€æµ‹
curl -X POST "http://localhost:8000/predict" \
  -H "Content-Type: application/json" \
  -d '{"text": "ä½ è¿™ä¸ªåƒåœ¾", "threshold": 0.5}'

# é¢„æœŸå“åº”åŒ…å« "category_hint": "è¾±éª‚/ä»‡æ¨/æ”»å‡»"
```

## Python æ¥å£ç¤ºä¾‹

```python
from src.predict import load_predictor

# åŠ è½½æ¨¡å‹
predictor = load_predictor('outputs/model')

# æµ‹è¯•ä¸åŒç±»å‹çš„å†…å®¹
test_cases = [
    "è¿™ä¸ªäº§å“å¾ˆå¥½ç”¨",              # é¢„æœŸ: pred=0, category_hint=""
    "åŠ å¾®ä¿¡VX123äº†è§£è¯¦æƒ…",          # é¢„æœŸ: pred=1, category_hint="å¹¿å‘Š/å¼•æµ"
    "ä½ è¿™ä¸ªå‚»é€¼",                   # é¢„æœŸ: pred=1, category_hint="è¾±éª‚/ä»‡æ¨/æ”»å‡»"
]

for text in test_cases:
    result = predictor.predict_one(text, threshold=0.5)
    print(f"æ–‡æœ¬: {result['text']}")
    print(f"é¢„æµ‹: {result['pred']}")
    print(f"ç±»åˆ«: {result['category_hint']}")
    print("---")
```

## éªŒæ”¶æ ‡å‡†

âœ… Streamlit é¡µé¢æ˜¾ç¤º:
  - æ¨¡å‹æ¦‚ç‡
  - è§„åˆ™åˆ†æ•°
  - æœ€ç»ˆæ¦‚ç‡
  - æ˜¯å¦æœ‰å®³ (æ–°æ ‡ç­¾: "æœ‰å®³å†…å®¹ï¼ˆè¾±éª‚/ä»‡æ¨/å¼•æµå¹¿å‘Šï¼‰")
  - **ç±»åˆ«æç¤º (category_hint)** â† æ–°å¢

âœ… FastAPI è¿”å› JSON åŒ…å«:
  - æ‰€æœ‰åŸæœ‰å­—æ®µ
  - **category_hint** â† æ–°å¢

âœ… ç°æœ‰è®­ç»ƒä¸æ¨ç†å‘½ä»¤:
  - å®Œå…¨ä¸å—å½±å“
  - å‘åå…¼å®¹

âœ… ç±»åˆ«æç¤ºå‡†ç¡®æ€§:
  - è§„åˆ™å‘½ä¸­ â†’ "å¹¿å‘Š/å¼•æµ"
  - å…³é”®è¯å‘½ä¸­ â†’ "è¾±éª‚/ä»‡æ¨/æ”»å‡»"
  - ä»…æ¨¡å‹åˆ¤å®š â†’ "æ¨¡å‹åˆ¤å®šï¼ˆæœªå‘½ä¸­è§„åˆ™/è¯è¡¨ï¼‰"
  - å®‰å…¨å†…å®¹ â†’ "" (ç©ºå­—ç¬¦ä¸²)
